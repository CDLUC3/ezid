{% extends "tabs.html" %}

{% block title %}EZID : Admin{% endblock %}

{% block header %}
<link rel="stylesheet" type="text/css"
href="/ezid/static/jquery.autocomplete.css"/>
<script type="text/javascript"
src="/ezid/static/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/ezid/static/admin.js"></script>
{% endblock %}

{% block javascript %}
defaultShoulders = "{{ defaultShoulders|escapejs }}";
{% endblock %}

{% block admintab %}active{% endblock %}

{% block content %}
<div id="admin">

<p><a id="ng_switch" class="switch" href="#"><span id="ng_open"
class="open"></span><span id="ng_close" class="closed"></span> Groups:
make new</a></p>

<div id="ng_section" class="section">
<form id="ng_form" action="null">
<p>Make an existing LDAP entry (person, institution, etc.) an EZID
group.</p>
<table class="form">
<tr>
<th>LDAP entry</th>
<td colspan="2"><input type="text" id="ng_entry" name="ng_entry"
size="60"/></td>
</tr>
<tr>
<th>Group name</th>
<td colspan="2"><input type="text" id="ng_gid" name="ng_gid" size="20"/>
<span class="note">E.g., "labarchives"</span></td>
</tr>
<tr>
<th>Agreement on file</th>
<td colspan="2"><input type="checkbox" id="ng_agreement"
name="ng_agreement"/></td>
</tr>
<tr>
<th>Shoulder list</th>
<td colspan="2"><input type="text" id="ng_shoulderlist" name="ng_shoulderlist"
size="60"/></td>
</tr>
<tr>
<td></td>
<td class="gap"></td>
<td class="note">Enter one or more shoulders separated by commas.
Choose from:
{% for s in shoulders %}
<span class="shoulder">{{ s }}</span>{% if forloop.last %}.{% else %},
{% endif %}
{% endfor %}
Or enter "NONE" to disable identifier creation.
</td>
</tr>
<tr>
<td></td>
<td colspan="2"><input type="submit" value="Make group"/></td>
</tr>
</table>
</form>
</div>

<p><a id="mg_switch" class="switch" href="#"><span id="mg_open"
class="open"></span><span id="mg_close" class="closed"></span> Groups:
manage existing</a></p>

<div id="mg_section" class="section">
<form id="mg_form" action="null">
<p>Manage an existing EZID group.  Due to session caching, if a
group's shoulder list is changed, users in that group with open
sessions will have to logout and login again to see the change.</p>
<table class="form">
<tr>
<th>Group</th>
<td colspan="2">
<select id="mg_select">
<option selected="selected">Loading groups...</option>
</select>
</td>
</tr>
<tr>
<th>LDAP entry</th>
<td id="mg_entry" colspan="2" class="value"></td>
</tr>
<tr>
<th>ARK identifier</th>
<td id="mg_arkid" colspan="2" class="value"></td>
</tr>
<tr>
<th>Users</th>
<td id="mg_users" colspan="2" class="value"></td>
</tr>
<tr>
<th>Agreement on file</th>
<td colspan="2"><input type="checkbox" id="mg_agreement"
name="mg_agreement"/></td>
</tr>
<tr>
<th>Shoulder list</th>
<td colspan="2"><input type="text" id="mg_shoulderlist" name="mg_shoulderlist"
size="60"/></td>
</tr>
<tr>
<td></td>
<td class="gap"></td>
<td class="note">Enter one or more shoulders separated by commas.
Choose from:
{% for s in shoulders %}
<span class="shoulder">{{ s }}</span>{% if forloop.last %}.{% else %},
{% endif %}
{% endfor %}
Or enter "NONE" to disable identifier creation.
</td>
</tr>
<tr>
<td></td>
<td colspan="2"><input type="submit" value="Update"/></td>
</tr>
</table>
</form>
</div>

<p><a id="nu_switch" class="switch" href="#"><span id="nu_open"
class="open"></span><span id="nu_close" class="closed"></span> Users:
make new</a></p>

<div id="nu_section" class="section">
<form id="nu_form" action="null">
<p>Make a new EZID user.</p>
<table class="form">
<tr>
<th rowspan="4" class="multiline">Username</th>
<td class="note">Either enter new username (e.g., "jdoe"):</td>
</tr>
<tr>
<td><input type="text" id="nu_uid" name="nu_uid" size="20"/></td>
</tr>
<tr>
<td class="note">Or select existing LDAP user:</td>
</tr>
<tr>
<td>
<select id="nu_userselect">
<option selected="selected">Loading LDAP users...</option>
</select>
</td>
</tr>
<tr>
<th>Group</th>
<td>
<select id="nu_groupselect">
<option selected="selected">Loading groups...</option>
</select>
</td>
</tr>
<tr>
<td></td>
<td><input type="submit" value="Make user"/></td>
</tr>
</table>
</form>
</div>

<p><a id="mu_switch" class="switch" href="#"><span id="mu_open"
class="open"></span><span id="mu_close" class="closed"></span> Users:
manage existing</a></p>

<div id="mu_section" class="section">
<form id="mu_form" action="null">
<p>Manage an existing EZID user.</p>
<table class="form">
<tr>
<th>Username</th>
<td colspan="2">
<input type="hidden" id="mu_uid" name="mu_uid"/>
<input type="hidden" id="mu_currentlyEnabled" name="mu_currentlyEnabled"/>
<select id="mu_select">
<option selected="selected">Loading users...</option>
</select>
</td>
</tr>
<tr>
<th>ARK identifier</th>
<td colspan="2" id="mu_arkid" class="value"></td>
</tr>
<tr>
<th>Group</th>
<td colspan="2" id="mu_gid" class="value"></td>
</tr>
<tr>
<th>First name</th>
<td colspan="2"><input type="text" id="mu_givenName" name="mu_givenName"
size="30"/></td>
</tr>
<tr>
<th>Last name</th>
<td colspan="2"><input type="text" id="mu_sn" name="mu_sn" size="30"/></td>
</tr>
<tr>
<th>Email address</th>
<td colspan="2"><input type="text" id="mu_mail" name="mu_mail" size="30"/></td>
</tr>
<tr>
<th>Phone number</th>
<td colspan="2"><input type="text" id="mu_telephoneNumber"
name="mu_telephoneNumber" size="30"/></td>
</tr>
<tr class="multiline">
<th>Description</th>
<td colspan="2"><textarea id="mu_description" name="mu_description" rows="5"
cols="40"></textarea></td>
</tr>
<tr>
<th>Co-owners</th>
<td colspan="2"><input type="text" id="mu_ezidCoOwners" name="mu_ezidCoOwners"
size="40"/></td>
</tr>
<tr>
<td></td>
<td class="gap"></td>
<td class="note">Separate usernames with commas.</td>
</tr>
<tr>
<th>Login enabled</th>
<td><input type="checkbox" id="mu_enabled" name="mu_enabled"/></td>
</tr>
<tr>
<th>New password</th>
<td colspan="2"><input type="text" id="mu_userPassword" name="mu_userPassword"
size="30"/></td>
</tr>
<tr>
<td></td>
<td colspan="2"><input type="submit" value="Update"/></td>
</tr>
</table>
</form>
</div>

<p><a id="ss_switch" class="switch" href="#"><span id="ss_open"
class="open"></span><span id="ss_close" class="closed"></span> System
status</a></p>

<div id="ss_section" class="section">
<table id="sstable">
</table>
</div>

<p><a id="sa_switch" class="switch" href="#"><span id="sa_open"
class="open"></span><span id="sa_close" class="closed"></span> Set
alert message</a></p>

<div id="sa_section" class="section">
<form method="post" action="/ezid/admin">
<p>The message will appear at the top of every page.</p>
<table class="form">
<tr>
<th>Message</th>
<td><input type="text" id="sa_message" name="message" size="60"/></td>
</tr>
<tr>
<td></td>
<td><input type="submit" value="Set"/>
<input type="hidden" name="operation" value="set_alert"/></td>
</tr>
</table>
</form>
</div>

<p><a id="rl_switch" class="switch" href="#"><span id="rl_open"
class="open"></span><span id="rl_close" class="closed"></span> Reload
EZID</a></p>

<div id="rl_section" class="section">
<form method="post" action="/ezid/admin/reload">
<p>Reloading EZID empties its caches and re-reads the configuration
file.  Due to session caching, it may be necessary for users with open
sessions to logout and login again to see the effects of configuration
changes, particularly those related to shoulders.</p>
<table class="form">
<tr><td><input type="submit" value="Reload"/></td></tr>
</table>
</form>
</div>

</div>
{% endblock %}
