{% load layout_extras %}
<div class="row vertical-buffer"></div>
<!-- div class="container-fluid" -->

  <div class="container-fluid">

<footer class="footer">

  <a class="footer__logo-link" href="http://www.cdlib.org/"><img class="footer__logo" src="/static/images/logoBottom.svg" alt="California Digital Library"></a>

  <div class="footer__news">
{% if feed_cache %}
    <h1 class="footer__news-title">Latest News from EZID</h1>

    <p class="footer__news-text">
      <!-- Vertical Bootstrap 3 Carousel
      http://stackoverflow.com/questions/11589816/twitter-bootstrap-carousel-vertical-sliding/11596944 -->
      <div id="newsCarousel" class="carousel slide" data-ride="carousel" data-interval="5000">
        <!-- Wrapper for slides -->
        <div class="carousel-inner vertical" role="listbox">
      {% for title, link in feed_cache %}
        {% if forloop.first %}
          <div class="item active">
        {% else %}
          <div class="item">
        {% endif %}
        {% if link == "None" %}
            {{ title }} 
        {% else %}
            <a href="{{ link }}">{{ title }}</a>
        {% endif %}
          </div>
      {% endfor %}
        </div>
      </div>
    </p>

    <a href="http://www.cdlib.org/cdlinfo/category/infrastructure-services/ezid/" class="footer__news-link">View all news</a>
{% endif %}
  </div>

  <div class="footer__icons">
    <a class="footer__icon-link" href="http://twitter.com/ezidcdl" title="Twitter"><img class="footer__icon" src="/static/images/iconTwitter.svg" alt="California Digital Library"></a>
    <a class="footer__icon-link" href="http://www.cdlib.org/cdlinfo/category/infrastructure-services/feed/?s=ezid" title="RSS"><img class="footer__icon" src="/static/images/iconRSS.svg" alt="California Digital Library"></a>
  </div>

  <div class="footer__copyright">
    <p class="footer__text">EZID is a service of the <a href="http://www.cdlib.org/" class="footer__link">California Digital Library</a>, a division of the <a href="http://www.universityofcalifornia.edu/" class="footer__link">University of California Office of the President</a></p>
    <p class="footer__text">Â© 2015 The Regents of the University of California</p>
    <a href="/home/about_us" class="footer__copyright-link">About Us</a>
    <a href="http://www.cdlib.org/about/privacy.html" class="footer__copyright-link">Privacy Policy</a>
  </div>

</footer>
</div>

<!-- /div -->
    <script>
    // Login Modal
      (function() {

      'use strict';

      // list out the vars
      var mOverlay = getId('modal_window'),
          mOpen = getId('modal_open'),
          mOpenFromSearchPg = getId('modal_open_pg-search'),
          mClose = getId('modal_close'),
          modal = getId('modal-holder'),
          page = getId('page_top'),
          modalOpen = false,
          lastFocus;


      // Let's cut down on what we need to type to get an ID
      function getId ( id ) {
        return document.getElementById(id);
      }


      // Let's open the modal
      function modalShow () {
        lastFocus = document.activeElement;
        page.setAttribute('aria-hidden', 'true');
        mOverlay.setAttribute('aria-hidden', 'false');
        modalOpen = true;
        modal.setAttribute('tabindex', '0');
        modal.focus();
      }


      // binds to both the button click and the escape key to close the modal window
      // but only if modalOpen is set to true
      function modalClose ( event ) {
        if (modalOpen && ( !event.keyCode || event.keyCode === 27 ) ) {
          mOverlay.setAttribute('aria-hidden', 'true');
          page.setAttribute('aria-hidden', 'false');
          modal.setAttribute('tabindex', '-1');
          modalOpen = false;
          lastFocus.focus();
        }
      }

      // Restrict focus to the modal window when it's open.
      // Tabbing will just loop through the whole modal.
      // Shift + Tab will allow backup to the top of the modal,
      // and then stop.
      function focusRestrict ( event ) {
        document.addEventListener('focus', function( event ) {
          if ( modalOpen && !modal.contains( event.target ) ) {
            event.stopPropagation();
            modal.focus();
          }
        }, true);
      }

      // Close modal window by clicking on the overlay
      mOverlay.addEventListener('click', function( e ) {
        if (e.target == modal.parentNode) {
           modalClose( e );
         }
      }, false);


      // open modal by btn click/hit
      mOpen.addEventListener('click', modalShow);
      if (mOpenFromSearchPg !== null) {
        mOpenFromSearchPg.addEventListener('click', modalShow);
      }

      // close modal by btn click/hit
      mClose.addEventListener('click', modalClose);

      // close modal by keydown, but only if modal is open
      document.addEventListener('keydown', modalClose);

      // restrict tab focus on elements only inside modal window
      window.addEventListener('keypress', focusRestrict);

    })();

  </script>
