# EZID configuration file.
#
# In an extension to Python's configuration file format, we allow an
# option to be prefixed with a deployment level in braces, e.g.,
#
#   {production}the_answer: 42
#
# If a deployment-level-specific value for an option corresponding to
# the current deployment level exists, that value is used; otherwise,
# the value for the option with no deployment level is used.
#
# Passwords and other sensitive information can and should be stored
# in the "shadow" version of this file.
#
# This file can be dynamically reloaded by sending an empty POST
# request to the URL http://{host}/admin/reload (admin authentication
# required).

[DEFAULT]
{localdev}ezid_base_url: http://localhost:8000
{remotedev}ezid_base_url: http://localhost:8000
{development}ezid_base_url: http://ias-ezid-dev.cdlib.org
{staging}ezid_base_url: http://ias-ezid-stg.cdlib.org
{workflow}ezid_base_url: http://ias-ezid-wf-stg.cdlib.org
{production}ezid_base_url: http://ezid.cdlib.org
default_doi_profile: datacite
default_ark_profile: erc
default_urn_uuid_profile: erc
max_threads_per_user: 8
max_concurrent_operations_per_user: 4
sqlite_busy_sleep: .01
store_database: %(SITE_ROOT)s/db/store.sqlite3
store_database_pool_limit: 2
search_database: %(SITE_ROOT)s/db/search.sqlite3
stats_file: %(SITE_ROOT)s/db/stats
google_analytics_id: none
{development}google_analytics_id: UA-30638119-2
{production}google_analytics_id: UA-30638119-7
idlewait_sleep: .1
gzip_command: /usr/bin/gzip

[daemons]
# The following enablement flags are subservient to the
# DAEMON_THREADS_ENABLED Django setting.
backproc_enabled: true
newsfeed_enabled: true
status_enabled: true
crossref_enabled: true
download_enabled: true
background_processing_idle_sleep: 5
status_logging_interval: 60
crossref_processing_idle_sleep: 5
download_processing_idle_sleep: 60

[newsfeed]
url: http://www.cdlib.org/cdlinfo/category/infrastructure-services/feed/?s=ezid
polling_interval: 1800

[email]
new_account_email: gjanee@ucop.edu
{production}new_account_email: jak@ucop.edu,jstarr@ucop.edu
# Identical error notification emails are suppressed for
# 'error_suppression_window' seconds; the timer is completely reset
# after 'error_lifetime' seconds.
error_suppression_window: 3600
error_lifetime: 14400

[binder]
enabled: true
url: https://ias-n2t-dev.n2t.net/a/ezid/b
{staging}url: https://ias-n2t-stg.n2t.net/a/ezid/b
{workflow}url: https://ias-n2t-wf-stg.n2t.net/a/ezid/b
{production}url: https://n2t.net/a/ezid/b
username: ezid
password: (see shadow file)

[resolver]
doi: http://dx.doi.org
# The ARK resolvers correspond to the above binders.
ark: http://ias-n2t-dev.n2t.net
{staging}ark: http://ias-n2t-stg.n2t.net
{workflow}ark: http://ias-n2t-wf-stg.n2t.net
{production}ark: http://n2t.net

[shoulders]
# The URL below may be a file:// URL to load the shoulders from a
# local source.  The username and password may be left empty if not
# required.
primary_url: https://n2t.net/e/pop/ezid/master_shoulders.txt
username: ezid
password: (see shadow file)
cache_file: %(SITE_ROOT)s/db/shoulders_cache.txt
ark_test: ark:/99999/fk4
doi_test: doi:10.5072/FK2
agent: ark:/99166/p9
minter_servers: main

[minter_server_main]
url: https://n2t.net/a/ezid/m
username: ezid
password: (see shadow file)

[datacite]
enabled: false
{production}enabled: true
doi_url: https://mds.datacite.org/doi
metadata_url: https://mds.datacite.org/metadata
num_attempts: 3
reattempt_delay: 5
timeout: 60
ping_doi: 10.5060/D2_EZID_STATUS_CHECK
ping_target: http://ezid.cdlib.org/
allocators: CDL,PURDUE

[allocator_CDL]
password: (see shadow file)

[allocator_PURDUE]
password: (see shadow file)

[crossref]
# The 'daemons.crossref_enabled' flag governs whether the CrossRef
# daemon thread runs.  The flag below governs if the daemon actually
# contacts CrossRef, or if CrossRef calls are simply short-circuited.
enabled: false
{production}enabled: true
depositor_name: EZID
depositor_email: ezidcdl@gmail.com
real_server: doi.crossref.org
test_server: test.crossref.org
deposit_url: http://%s/servlet/deposit
results_url: http://%s/servlet/submissionDownload
username: cdlb
password: (see shadow file)

[profiles]
# Note: the internal profile is special and must be listed first.
keys: INTERNAL,datacite,dc,erc,crossref

[profile_INTERNAL]
name: internal
display_name: internal
editable: false
file: %(PROJECT_ROOT)s/profiles/internal.profile

[profile_datacite]
name: datacite
display_name: DataCite
editable: true
file: %(PROJECT_ROOT)s/profiles/datacite.profile

[profile_dc]
name: dc
display_name: Dublin Core
editable: true
file: %(PROJECT_ROOT)s/profiles/dc.profile

[profile_erc]
name: erc
display_name: ERC
editable: true
file: %(PROJECT_ROOT)s/profiles/erc.profile

[profile_crossref]
name: crossref
display_name: CrossRef
editable: false
file: %(PROJECT_ROOT)s/profiles/crossref.profile

[oai]
enabled: true
repository_name: EZID
admin_email: ezid@ucop.edu
batch_size: 100

[ldap]
enabled: true
{remotedev}enabled: false
# Use caution in setting the following flag to true: EZID caches LDAP
# information in agent identifiers in the bind database.  If, say, an
# instance of EZID uses the same LDAP server as the production
# instance, but a different bind database, then a whole host of
# problems may ensue: information may be cached in the wrong bind
# database, an agent identifier may not exist, an agent identifier may
# be created in the wrong bind database, etc.
updates_enabled: false
{production}updates_enabled: true
{development}updates_enabled: true
server: ldaps://uc3-ldap.cdlib.org:1636/
{development}server: ldaps://uc3-mrt-wrk1-stg.cdlib.org:1636/
{remotedev}server: ldaps://localhost:1636/
num_attempts: 3
reattempt_delay: 5
cached_password_lifetime: 1800
base_dn: ou=uc3,dc=cdlib,dc=org
user_dn_template: uid=%s,ou=People,ou=uc3,dc=cdlib,dc=org
group_dn_template: o=%s,ou=ezid-groups,ou=uc3,dc=cdlib,dc=org
# To clarify the following: admin_username is the username of the EZID
# administrator account, which is special to EZID but otherwise a
# regular LDAP user.  ldap_admin_dn is the (privileged) LDAP
# administrator account.
admin_username: admin
admin_password: (see shadow file)
ldap_admin_dn: cn=Directory Manager
ldap_admin_password: (see shadow file)

# The following user and group options are used only if LDAP is *not*
# enabled.  (The EZID administrator username is always determined by
# ldap.admin_username above, though.)

[groups]
keys: admin,apitest

# Enter "NONE" for the shoulders below to disable identifier creation.

[group_admin]
id: ark:/99166/p9g44hq02
shoulders: *
crossref_enabled: true
crossref_mail:
crossref_send_mail_on_error: false

[group_apitest]
id: ark:/99166/p9pg1hn29
shoulders: ark:/13030/c7 doi:10.5060/D2
crossref_enabled: false
crossref_mail:
crossref_send_mail_on_error: false

[users]
keys: admin,apitest

[user_admin]
password: admin
id: ark:/99166/p9kw57h4w
group: admin
co_owners:

[user_apitest]
password: apitest
id: ark:/99166/p9jq0st8j
group: apitest
co_owners:
